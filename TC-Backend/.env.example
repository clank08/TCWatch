# TCWatch Backend Environment Configuration
# Copy this file to .env and update the values for your environment

# ===========================================
# Application Configuration
# ===========================================
NODE_ENV=development
PORT=3000
API_VERSION=v1

# ===========================================
# Database Configuration
# ===========================================
# Supabase Configuration (Managed PostgreSQL + Auth)
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_ANON_KEY=your_supabase_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here
SUPABASE_JWT_SECRET=your_supabase_jwt_secret_here

# Database Connection for Prisma (using Supabase)
SUPABASE_DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres
DATABASE_URL=${SUPABASE_DATABASE_URL}
DIRECT_URL=${SUPABASE_DATABASE_URL}

# Database Pool Configuration
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_IDLE_TIMEOUT=30000

# ===========================================
# Cache Configuration
# ===========================================
# Redis Configuration
REDIS_URL=redis://default:dev_redis_123@localhost:6379
REDIS_PASSWORD=dev_redis_123
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0

# Cache TTL Settings (in seconds)
CACHE_TTL_SHORT=300    # 5 minutes
CACHE_TTL_MEDIUM=3600  # 1 hour
CACHE_TTL_LONG=86400   # 24 hours

# ===========================================
# Search Configuration
# ===========================================
# Meilisearch Configuration (Local for development, Cloud for production)
MEILISEARCH_HOST=http://localhost:7700
MEILISEARCH_MASTER_KEY=dev_meili_master_key_123
MEILISEARCH_API_KEY=dev_meili_master_key_123

# Meilisearch Cloud Configuration (for production)
# MEILISEARCH_HOST=https://ms-your-project-id.fra.meilisearch.io
# MEILISEARCH_API_KEY=your_meilisearch_cloud_api_key

# Search Index Configuration
MEILISEARCH_CONTENT_INDEX=tcwatch_content
MEILISEARCH_USERS_INDEX=tcwatch_users
MEILISEARCH_CASES_INDEX=tcwatch_cases

# ===========================================
# Workflow Orchestration
# ===========================================
# Temporal Cloud Configuration
TEMPORAL_CLOUD_URL=your-namespace.tmprl.cloud:7233
TEMPORAL_NAMESPACE=your-namespace.tmprl.cloud
TEMPORAL_TASK_QUEUE=tcwatch-tasks
TEMPORAL_CLOUD_API_KEY=your_temporal_cloud_api_key
TEMPORAL_TLS_CERT_PATH=./certs/client.pem
TEMPORAL_TLS_KEY_PATH=./certs/client.key

# Workflow Settings
WORKFLOW_MAX_RETRIES=3
WORKFLOW_RETRY_DELAY=1000
WORKFLOW_TIMEOUT=300000

# ===========================================
# Authentication & Security
# ===========================================
# JWT Configuration
JWT_SECRET=your_super_secure_jwt_secret_key_here_min_32_chars
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Session Configuration
SESSION_SECRET=your_session_secret_here_min_32_chars
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_MAX_AGE=86400000

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100  # requests per window
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# CORS Configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:8081,http://localhost:19006
CORS_CREDENTIALS=true

# ===========================================
# External API Configuration
# ===========================================
# Watchmode API (Streaming Availability)
WATCHMODE_API_KEY=your_watchmode_api_key_here
WATCHMODE_BASE_URL=https://api.watchmode.com/v1

# The Movie Database (TMDb) API
TMDB_API_KEY=your_tmdb_api_key_here
TMDB_BASE_URL=https://api.themoviedb.org/3
TMDB_IMAGE_BASE_URL=https://image.tmdb.org/t/p

# TheTVDB API
THETVDB_API_KEY=your_thetvdb_api_key_here
THETVDB_BASE_URL=https://api4.thetvdb.com/v4

# TVMaze API
TVMAZE_API_KEY=your_tvmaze_api_key_here
TVMAZE_BASE_URL=https://api.tvmaze.com

# Wikidata API
WIKIDATA_BASE_URL=https://www.wikidata.org/w/api.php
WIKIDATA_SPARQL_URL=https://query.wikidata.org/sparql

# ===========================================
# API Rate Limiting Configuration
# ===========================================
# External API Rate Limits (requests per minute)
WATCHMODE_RATE_LIMIT=60
TMDB_RATE_LIMIT=40
THETVDB_RATE_LIMIT=20
TVMAZE_RATE_LIMIT=20
WIKIDATA_RATE_LIMIT=30

# ===========================================
# File Storage Configuration
# ===========================================
# Supabase Storage Configuration
SUPABASE_STORAGE_BUCKET=tcwatch-uploads
SUPABASE_STORAGE_URL=https://your-project-ref.supabase.co/storage/v1

# Local File Storage (Development)
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,image/gif

# ===========================================
# Logging Configuration
# ===========================================
LOG_LEVEL=info
LOG_FORMAT=combined
LOG_FILE=logs/tcwatch.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5

# ===========================================
# Monitoring & Analytics
# ===========================================
# Sentry Configuration (Error Tracking)
SENTRY_DSN=your_sentry_dsn_here
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Health Check Configuration
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_INTERVAL=30000

# ===========================================
# Email Configuration
# ===========================================
# SMTP Configuration for notifications
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password_here

# Email Templates
FROM_EMAIL=noreply@tcwatch.com
FROM_NAME=TCWatch

# ===========================================
# Development Tools
# ===========================================
# Redis Commander (Development GUI)
REDIS_COMMANDER_PASSWORD=admin123

# Note: Database GUI is available through Supabase Dashboard
# No local Adminer needed - use https://app.supabase.com for database management

# Debug Configuration
DEBUG_ENABLED=true
DEBUG_NAMESPACE=tcwatch:*

# ===========================================
# Feature Flags
# ===========================================
FEATURE_SOCIAL_ENABLED=true
FEATURE_NOTIFICATIONS_ENABLED=true
FEATURE_RECOMMENDATIONS_ENABLED=true
FEATURE_ANALYTICS_ENABLED=false

# ===========================================
# Performance Configuration
# ===========================================
# Request timeout settings
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=5000
HEADERS_TIMEOUT=60000

# Cluster configuration
CLUSTER_WORKERS=0  # 0 = auto (CPU cores), > 0 = specific number